\documentclass[12pt, titlepage]{article}

\usepackage{fullpage}
\usepackage[round]{natbib}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{float}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=blue,
    filecolor=black,
    linkcolor=red,
    urlcolor=blue
}

\input{../../Comments}
\input{../../Common}

\newcounter{acnum}
\newcommand{\actheacnum}{AC\theacnum}
\newcommand{\acref}[1]{AC\ref{#1}}

\newcounter{ucnum}
\newcommand{\uctheucnum}{UC\theucnum}
\newcommand{\uref}[1]{UC\ref{#1}}

\newcounter{mnum}
\newcommand{\mthemnum}{M\themnum}
\newcommand{\mref}[1]{M\ref{#1}}

\begin{document}

\title{Module Guide for \progname{}} 
\author{\authname}
\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Nov. 13, 2025 & 1.0 & First revision of MG Document \\
\bottomrule
\end{tabularx}

\newpage

\section{Reference Material}

This section records information for easy reference.

\subsection{Abbreviations and Acronyms}

\renewcommand{\arraystretch}{1.2}
\begin{tabular}{l l} 
  \toprule		
  \textbf{symbol} & \textbf{description}\\
  \midrule 
  AC & Anticipated Change\\
  DAG & Directed Acyclic Graph \\
  M & Module \\
  MG & Module Guide \\
  OS & Operating System \\
  R & Requirement\\
  SC & Scientific Computing \\
  SRS & Software Requirements Specification\\
  \progname & Explanation of program name\\
  UC & Unlikely Change \\
  \wss{etc.} & \wss{...}\\
  \bottomrule
\end{tabular}\\

\newpage

\tableofcontents

\listoftables

\listoffigures

\newpage

\pagenumbering{arabic}

\section{Introduction}

Decomposing a system into modules is a commonly accepted approach to developing
software.  A module is a work assignment for a programmer or programming
team~\citep{ParnasEtAl1984}.  We advocate a decomposition
based on the principle of information hiding~\citep{Parnas1972a}.  This
principle supports design for change, because the ``secrets'' that each module
hides represent likely future changes.  Design for change is valuable in SC,
where modifications are frequent, especially during initial development as the
solution space is explored.  

Our design follows the rules layed out by \citet{ParnasEtAl1984}, as follows:
\begin{itemize}
\item System details that are likely to change independently should be the
  secrets of separate modules.
\item Each data structure is implemented in only one module.
\item Any other program that requires information stored in a module's data
  structures must obtain it by calling access programs belonging to that module.
\end{itemize}

After completing the first stage of the design, the Software Requirements
Specification (SRS), the Module Guide (MG) is developed~\citep{ParnasEtAl1984}. The MG
specifies the modular structure of the system and is intended to allow both
designers and maintainers to easily identify the parts of the software.  The
potential readers of this document are as follows:

\begin{itemize}
\item New project members: This document can be a guide for a new project member
  to easily understand the overall structure and quickly find the
  relevant modules they are searching for.
\item Maintainers: The hierarchical structure of the module guide improves the
  maintainers' understanding when they need to make changes to the system. It is
  important for a maintainer to update the relevant sections of the document
  after changes have been made.
\item Designers: Once the module guide has been written, it can be used to
  check for consistency, feasibility, and flexibility. Designers can verify the
  system in various ways, such as consistency among modules, feasibility of the
  decomposition, and flexibility of the design.
\end{itemize}

The rest of the document is organized as follows. Section
\ref{SecChange} lists the anticipated and unlikely changes of the software
requirements. Section \ref{SecMH} summarizes the module decomposition that
was constructed according to the likely changes. Section \ref{SecConnection}
specifies the connections between the software requirements and the
modules. Section \ref{SecMD} gives a detailed description of the
modules. Section \ref{SecTM} includes two traceability matrices. One checks
the completeness of the design against the requirements provided in the SRS. The
other shows the relation between anticipated changes and the modules. Section
\ref{SecUse} describes the use relation between modules.

\section{Anticipated and Unlikely Changes} \label{SecChange}

This section lists possible changes to the system. According to the likeliness
of the change, the possible changes are classified into two
categories. Anticipated changes are listed in Section \ref{SecAchange}, and
unlikely changes are listed in Section \ref{SecUchange}.

\subsection{Anticipated Changes} \label{SecAchange}

Anticipated changes are the source of the information that is to be hidden
inside the modules. Ideally, changing one of the anticipated changes will only
require changing the one module that hides the associated decision. The approach
adapted here is called design for
change.

\begin{description}
\item[\refstepcounter{acnum} \actheacnum \label{acDashboard}:] The design and presentation of output data may evolve as we introduce a dashboard for post-session and real-time analytics. Visualizations and their underlying implementations are expected to change based on usability feedback and new instructor needs.
\item[\refstepcounter{acnum} \actheacnum \label{acHomography}:] The current homography module is anticipated to be updated with lighter-weight or more efficient algorithms. These changes aim to improve alignment accuracy and reduce latency for real-time gaze projection.

\item[\refstepcounter{acnum} \actheacnum \label{acAnalytics}:] Additional analytics such as engagement metrics or anomaly detection may be added as part of the dashboard.

\item[\refstepcounter{acnum} \actheacnum \label{acPrivacy}:] A privacy module may be added to the SocialEyes framework used to censor sensitive information that may be captured in gaze data (e.g: phone screen, laptop screen, human faces) if time permits. 

\end{description}

\subsection{Unlikely Changes} \label{SecUchange}

The module design should be as general as possible. However, a general system is
more complex. Sometimes this complexity is not necessary. Fixing some design
decisions at the system architecture stage can simplify the software design. If
these decision should later need to be changed, then many parts of the design
will potentially need to be modified. Hence, it is not intended that these
decisions will be changed.

\begin{description}
\item[\refstepcounter{ucnum} \uctheucnum \label{ucHardware}:] The existing system relies on fixed hardware (Pupil Labs Neon Eye Tracking Glasses, Android smartphone, network webcam), and changing these devices would require extensive redesign. 

\item[\refstepcounter{ucnum} \uctheucnum \label{ucAPIs}:] The pipeline depends heavily on Pupil Labs’ APIs for data access and synchronization. Modifying or replacing these APIs would impact multiple system components, making such changes unlikely.

\item[\refstepcounter{ucnum} \uctheucnum \label{ucInput}:] The system assumes specific input data formats. Altering these formats would require large-scale changes to parsing and processing modules.

\item[\refstepcounter{ucnum} \uctheucnum \label{ucCLI}:] The existing CLI supports essential homography, visualization, and analysis functions. Its role in offline processing makes major changes unlikely.

\item[\refstepcounter{ucnum} \uctheucnum \label{ucGlassesRecordModule}:] The existing GlassesRecord module handles multi-glasses recording and synchronization through a custom terminal interface will most likely not be changed. 





\end{description}

\section{Module Hierarchy} \label{SecMH}

This section provides an overview of the module design. Modules are summarized
in a hierarchy decomposed by secrets in Table \ref{TblMH}. The modules listed
below, which are leaves in the hierarchy tree, are the modules that will
actually be implemented.

\begin{description}
  \item[\refstepcounter{mnum} \mthemnum \label{mHH}:] Hardware-Hiding Module

  \item[\refstepcounter{mnum} \mthemnum \label{mDIM}:] Data Ingestion Module

  \item[\refstepcounter{mnum} \mthemnum \label{mRTS}:] Real-Time Streaming Module

  \item[\refstepcounter{mnum} \mthemnum \label{mDVM}:] Dashboard Visualization Module

  \item[\refstepcounter{mnum} \mthemnum \label{mRM}:] Reporting Module

  \item[\refstepcounter{mnum} \mthemnum \label{mDPM}:] Data Preprocessing Module

  \item[\refstepcounter{mnum} \mthemnum \label{mPIM}:] Privacy \& Infrastructure Module

  \item[\refstepcounter{mnum} \mthemnum \label{mEAM}:] Engagement Analytics Module

  \item[\refstepcounter{mnum} \mthemnum \label{mCVAM}:] Correlation \& Visual Analysis Module
\end{description}


\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

Hardware-Hiding Module & Hardware-Hiding Module (\mref{mHH}) \\
\midrule

\multirow{4}{0.3\textwidth}{Behaviour-Hiding Module} 
  & Data Ingestion Module (\mref{mDIM})\\
  & Real-Time Streaming Module (\mref{mRTS})\\
  & Dashboard Visualization Module (\mref{mDVM})\\
  & Reporting Module (\mref{mRM})\\
\midrule

\multirow{4}{0.3\textwidth}{Software Decision Module} 
  & Data Preprocessing Module (\mref{mDPM})\\
  & Privacy \& Infrastructure Module (\mref{mPIM})\\
  & Engagement Analytics Module (\mref{mEAM})\\
  & Correlation \& Visual Analysis Module (\mref{mCVAM})\\
\bottomrule

\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}


\section{Connection Between Requirements and Design} \label{SecConnection}

The design of the system is intended to satisfy the requirements developed in
the SRS. In this stage, the system is decomposed into modules. The connection
between requirements and modules is listed in Table~\ref{TblRT}.

\wss{The intention of this section is to document decisions that are made
  ``between'' the requirements and the design.  To satisfy some requirements,
  design decisions need to be made.  Rather than make these decisions implicit,
  they are explicitly recorded here.  For instance, if a program has security
  requirements, a specific design decision may be made to satisfy those
  requirements with a password.}

  \begin{itemize}

  \item \textbf{Separation of data ingestion from preprocessing:}
  Requirements relating to multi-device input, raw data capture, timing
  synchronization, and recovery from connection loss motivated the creation of a
  dedicated \emph{Data Ingestion Module}. Requirements concerning noise
  reduction, calibration correction, homography projection, and coordinate
  normalization are distinct and subject to change independently, motivating the
  \emph{Data Preprocessing Module}. This reflects the SRS separation between raw
  data capture and analytic data preparation.

  \item \textbf{Explicit handling of real-time constraints:}
  The need for live metrics, dashboard updating, latency guarantees, and
  real-time streaming (as described in the SRS operational modes) led to the
  creation of a separate \emph{Real-Time Streaming Module}. This encapsulates
  decisions about streaming frameworks, buffering policy, and delivery latency,
  which are likely to evolve as performance constraints change.

  \item \textbf{Distinguishing analytics computation from visualization:}
  Engagement metrics, instructor–student gaze alignment, heatmap generation,
  and correlation analyses are internal computations not directly described to
  the end user. These behaviours motivated two separate software-decision
  modules: the \emph{Engagement Analytics Module} and the \emph{Correlation \&
  Visual Analysis Module}. Meanwhile, all visible UI behaviours—including
  real-time views, playback, filtering, and seat-map interactions—are grouped in
  the \emph{Dashboard Visualization Module}. This follows the SRS distinction
  between analytic computation and user-facing presentation.

  \item \textbf{Privacy and anonymization as a first-class design concern:}
  The SRS explicitly lists privacy, anonymization, secure handling of raw video,
  and compliance with data retention constraints. These requirements cannot be
  embedded inside ingestion, analytics, or dashboard logic without creating
  strong coupling. They therefore motivate the independent
  \emph{Privacy \& Infrastructure Module}, which encapsulates the design
  decisions related to face blurring, spatial masking, secure storage,
  authorization, and logging.

  \item \textbf{Support for offline summaries and instructor reporting:}
  Requirements calling for post-session summaries, exportable metrics, and
  instructor-friendly performance reports lead to the \emph{Reporting Module}.
  This module encapsulates decisions about report structure, export format, and
  summarization logic—decisions that are likely to change independently of both
  preprocessing and dashboard design.

  \item \textbf{Abstraction of physical devices and OS services:}
  The SRS assumes multiple hardware sources (eye-tracking glasses, central
  camera, audio, file storage, and network interfaces). To prevent downstream
  modules from depending on specific device drivers or OS-level behaviour, a
  general \emph{Hardware-Hiding Module} is included. This encapsulates the
  design decision to virtualize camera and sensor access, a key anticipated
  change identified in the hazards and SRS (e.g., replacing Neon with another
  device).

  \item \textbf{Backend service and session-lifecycle requirements:}
  The SRS specifies requirements for creating, managing, and retrieving recorded
  sessions, as well as backend API access for live or historical data (SRS:
  Service \& API requirements; Session Lifecycle Requirements). These behaviours
  are not purely real-time streaming nor visualization concerns. This motivated
  folding backend session-control logic into the \emph{Real-Time Streaming
  Module}, which now encapsulates API endpoints for session creation, playback
  control, and client subscriptions.

  \item \textbf{Secure storage, retention, and access-control requirements:}
  The SRS defines requirements for data retention policies, authenticated access,
  role-based controls (e.g., instructor vs.\ researcher), and logging of data
  access. Embedding these into ingestion or analytics would create tight coupling,
  so these decisions are isolated in the \emph{Privacy \& Infrastructure Module}.
  This module therefore owns secure storage, retention strategy, authorization,
  and audit logging as design decisions hidden from the rest of the system.

\end{itemize}

Overall, the module structure shows the boundaries between behaviours visible
to the user, performance-driven internal computations, privacy-critical
infrastructure, and hardware-specific interactions. This makes sure that changes in
requirements - such as improved analytics, new privacy constraints, or new
hardware - affect only the module that hides the corresponding decision.

\section{Module Decomposition} \label{SecMD}

Modules are decomposed according to the principle of ``information hiding''
proposed by \citet{ParnasEtAl1984}. The \emph{Secrets} field in a module
decomposition is a brief statement of the design decision hidden by the
module. The \emph{Services} field specifies \emph{what} the module will do
without documenting \emph{how} to do it. For each module, a suggestion for the
implementing software is given under the \emph{Implemented By} title. If the
entry is \emph{OS}, this means that the module is provided by the operating
system or by standard programming language libraries.  \emph{\progname{}} means the
module will be implemented by the \progname{} software.

Only the leaf modules in the hierarchy have to be implemented. If a dash
(\emph{--}) is shown, this means that the module is not a leaf and will not have
to be implemented.

\subsection{Hardware Hiding Module (\mref{mHH})}

\begin{description}
\item[Secrets:] The device-specific interfaces, drivers, and low-level OS
mechanisms used to access eye-tracking glasses (Neon), world camera
input, microphones, GPU acceleration, file system APIs, local and cloud
storage backends, network sockets, and system time synchronization (e.g.,
NTP services).
\item[Services:] Provides a virtualized hardware interface for capturing gaze
streams, world camera frames, audio signals, timestamps, and device metadata,
and for reading/writing data to persistent storage. Exposes uniform APIs so
downstream modules do not depend on specific device models, storage engines,
or operating systems.
\item[Implemented By:] OS, vendor SDKs, device drivers
\item[Type of Module:] Library
\end{description}

\subsection{Behaviour-Hiding Modules}

\begin{description}
\item[Secrets:] The externally visible behaviours of the system, including
session playback, dashboard display logic, ingestion behaviour, and reporting
rules as defined in the SRS.
\item[Services:] Provides all user-facing behaviours, connecting virtualized
hardware to internal algorithms. These modules must change if the SRS behaviour
changes.
\item[Implemented By:] --
\end{description}

\subsubsection{Data Ingestion Module (\mref{mDIM})}

\begin{description}
\item[Secrets:] The method of connecting to and receiving data from multiple
hardware sources (glasses, cameras, microphones), including device protocols,
buffering policy, timestamp alignment strategy (including use of system/NTP
time), and fault-recovery behaviour for dropped connections or device failures.
\item[Services:]
\begin{itemize}
  \item Accepts raw gaze, video, audio, and metadata streams from all devices.
  \item Performs initial timestamping and session indexing using a common time
        base.
  \item Manages session start/stop hooks that allow backend services to create
        sessions, register participants, and mark completed recordings.
  \item Outputs unified raw data packets for preprocessing and optional storage.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Abstract Object
\end{description}

\subsubsection{Real-Time Streaming Module (\mref{mRTS})}

\begin{description}
\item[Secrets:] The design decisions for real-time transport (Kafka, WebSockets),
latency buffering, stream synchronization, retry/timeout strategies, throttling,
and the external API endpoints through which clients subscribe to streams and
control session state (e.g., REST/GraphQL/WebSocket interfaces).
\item[Services:]
\begin{itemize}
  \item Exposes backend APIs for creating, listing, and controlling live or
        replay sessions (start, pause, stop) used by the dashboard and other
        clients.
  \item Delivers live preprocessed data and analytics to the dashboard and other
        authorized consumers with bounded latency.
  \item Maintains real-time session state (live/offline toggle, paused state,
        health status) and reports it to monitoring/logging infrastructure.
  \item Ensures smooth playback for recorded sessions by streaming stored data
        through the same interfaces used for live sessions.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Abstract Object
\end{description}

\subsubsection{Dashboard Visualization Module (\mref{mDVM})}

\begin{description}
\item[Secrets:] The visualization grammar, UI layout, interaction rules,
playback controls, and display logic for heatmaps, timelines, seat maps,
and instructor–student alignment graphs.
\item[Services:]
\begin{itemize}
  \item Presents real-time and historical analytics.
  \item Renders heatmaps, fixation charts, engagement over time, and gaze-alignment plots.
  \item Supports filters (student, seat zone, activity type, time window).
  \item Provides playback and zoom-in on individual student streams.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Abstract Object
\end{description}

\subsubsection{Reporting Module (\mref{mRM})}

\begin{description}
\item[Secrets:] The structure and formatting of summaries, metrics, annotations,
and export formats (PDF/HTML) and the rules for instructor reflection.
\item[Services:]
\begin{itemize}
  \item Generates session summaries, attention-duration metrics, and engagement timelines.
  \item Produces exportable reports for instructors and teaching portfolios.
  \item Supports annotation, note-taking, screengrabs, and timeline cropping.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Library
\end{description}

\subsection{Software Decision Modules}

\begin{description}
\item[Secrets:] Internal algorithms, mathematical models, data structures, and
analytic methods that are not externally visible. These change primarily due to
performance or research-driven improvements, not due to changes in behaviour.
\item[Services:] Provides internal data processing, analytics, correlations, and
privacy enforcement services for behaviour-hiding modules.
\item[Implemented By:] --
\end{description}

\subsubsection{Data Preprocessing Module (\mref{mDPM})}

\begin{description}
\item[Secrets:] Filtering algorithms (smoothing, denoising), calibration
transformations, gaze-to-screen homography methods, fixation detection rules,
and temporal alignment techniques.
\item[Services:]
\begin{itemize}
  \item Converts raw gaze vectors into screen/world-space coordinates.
  \item Denoises and filters gaze data.
  \item Identifies fixations, saccades, attention windows.
  \item Standardizes multimodal streams for analytics.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Abstract Data Type
\end{description}

\subsubsection{Privacy \& Infrastructure Module (\mref{mPIM})}

\begin{description}
\item[Secrets:] The anonymization pipeline, face-blurring method, device
obfuscation, consent rules, access-control and role-based authorization
policies, logging and monitoring configuration, database schema and storage
layout for raw and processed data, and data retention and deletion strategy.
\item[Services:]
\begin{itemize}
  \item Performs face blurring, device masking, and area-of-interest redaction
        on video and gaze data before it is exposed to user-facing modules.
  \item Ensures audio and video privacy filtering before data reaches the dashboard.
  \item Manages authentication and authorization for backend APIs and the
        dashboard (e.g., instructor vs.\ researcher roles).
  \item Provides secure storage and retrieval of raw and processed data in the
        underlying database or file system according to defined retention rules.
  \item Provides logging and monitoring hooks (e.g., audit logs, API access
        logs, health checks) used by other modules.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Library
\end{description}

\subsubsection{Engagement Analytics Module (\mref{mEAM})}

\begin{description}
\item[Secrets:] The mathematical models used to compute engagement metrics,
moving averages, attention peaks/troughs, activity-phase detection, and time-on-task calculations.
\item[Services:]
\begin{itemize}
  \item Computes engagement over time for individuals and aggregates.
  \item Detects disengagement periods and high-attention intervals.
  \item Classifies lecture activities (discussion, slides, group work).
  \item Generates metrics for reporting and dashboard visualization.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Abstract Data Type
\end{description}

\subsubsection{Correlation \& Visual Analysis Module (\mref{mCVAM})}

\begin{description}
\item[Secrets:] The gaze-correlation model, instructor–student alignment formulas,
visual material detection (text block, image region), and methods for transforming
heatmaps into interpretable coordinate-space analytics.
\item[Services:]
\begin{itemize}
  \item Computes correlations between instructor gaze and class gaze.
  \item Maps class attention onto slide regions or world-camera space.
  \item Identifies which visual elements students focus on, and how this changes over time.
  \item Supports seat-map and spatial-zone based metrics and filters.
\end{itemize}
\item[Implemented By:] \progname{}
\item[Type of Module:] Abstract Data Type
\end{description}

\section{Traceability Matrix} \label{SecTM}

This section shows two traceability matrices: between the modules and the
requirements and between the modules and the anticipated changes.

% the table should use mref, the requirements should be named, use something
% like fref
\begin{table}[H]
\centering
\begin{tabular}{p{0.2\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Req.} & \textbf{Modules}\\
\midrule
FR-3 & \mref{mHH}, \mref{mDIM} \\
FR-7 & \mref{mDPM} \\
FR-8 & \mref{mDPM} \\
FR-9 & \mref{mEAM} \\
FR-15 & \mref{mDVM}, \mref{mRTS} \\
FR-16 & \mref{mRM} \\
FR-21 & \mref{mPIM} \\
NFR-1 & \mref{mDPM}, \mref{mDVM} \\
NFR-3 & \mref{mHH}, \mref{mDIM} \\
NFR-11 & \mref{mPIM} \\
\bottomrule
\end{tabular}
\caption{Trace Between Requirements and Modules}
\label{TblRT}
\end{table}

\begin{table}[H]
\centering
\begin{tabular}{p{0.2\textwidth} p{0.6\textwidth}}
\toprule
\textbf{AC} & \textbf{Modules}\\
\midrule
\acref{acDashboard} & \mref{mDVM}, \mref{mRM}, \mref{mDPM} \mref{mEAM}, \mref{mCVAM} \\
\acref{acHomography} & \mref{mRTS}, \mref{mDPM} \\
\acref{acAnalytics} & \mref{mDPM}, \\
\acref{acPrivacy} & \mref{mPIM}\\
\bottomrule
\end{tabular}
\caption{Trace Between Anticipated Changes and Modules}
\label{TblACT}
\end{table}

\section{Use Hierarchy Between Modules} \label{SecUse}

In this section, the uses hierarchy between modules is
provided. \citet{Parnas1978} said of two programs A and B that A {\em uses} B if
correct execution of B may be necessary for A to complete the task described in
its specification. That is, A {\em uses} B if there exist situations in which
the correct functioning of A depends upon the availability of a correct
implementation of B.  Figure \ref{FigUH} illustrates the use relation between
the modules. It can be seen that the graph is a directed acyclic graph
(DAG). Each level of the hierarchy offers a testable and usable subset of the
system, and modules in the higher level of the hierarchy are essentially simpler
because they use modules from the lower levels.

At a high level, the use hierarchy for \progname{} is organized into layers:

\begin{itemize}
  \item \textbf{Level 0 – Hardware layer}: 
  Hardware-Hiding Module (M1) encapsulates the details of the Pupil Labs Neon
  glasses, central camera, and instructor workstation. No other module is used
  by M1.

  \item \textbf{Level 1 – Data acquisition}: 
  Data Ingestion Module (M2) uses M1 to collect raw gaze and video streams from
  the eye-tracking hardware and central camera.

  \item \textbf{Level 2 – Preparation and infrastructure}: 
  Data Preprocessing Module (M6) uses M2 to filter, normalize, and structure
  the captured data.  
  Privacy \& Infrastructure Module (M7) uses M1, M2, and M6 to apply
  anonymization, access control, and secure storage over the ingested and
  preprocessed data.

  \item \textbf{Level 3 – Analytics and streaming}: 
  Real-Time Streaming Module (M3) uses M2, M6, and M7 to serve live, privacy-
  compliant streams to the dashboard.  
  Engagement Analytics Module (M8) uses M6 to compute engagement metrics over
  preprocessed data.  
  Correlation \& Visual Analysis Module (M9) uses M6 and M8 to compute
  gaze-correlation and spatial visual analytics.

  \item \textbf{Level 4 – User-facing visualization}: 
  Dashboard Visualization Module (M4) uses M3, M7, M8, and M9 to display
  real-time and historical analytics while respecting privacy constraints.

  \item \textbf{Level 5 – Reporting and exports}: 
  Reporting Module (M5) uses M4, M8, and M9 to generate summaries and exported
  reports based on the visualizations and analytics.
\end{itemize}

The main uses relations can be summarized as:

\begin{itemize}
  \item M2 uses M1.
  \item M6 uses M2.
  \item M7 uses M1, M2, and M6.
  \item M3 uses M2, M6, and M7.
  \item M8 uses M6.
  \item M9 uses M6 and M8.
  \item M4 uses M3, M7, M8, and M9.
  \item M5 uses M4, M8, and M9.
\end{itemize}

\begin{figure}[H]
\centering
%\includegraphics[width=0.7\textwidth]{UsesHierarchy.png}
\caption{Use hierarchy among modules}
\label{FigUH}
\end{figure}

%\section*{References}

\section{User Interfaces}

\wss{Design of user interface for software and hardware.  Attach an appendix if
needed. Drawings, Sketches, Figma}

\section{Design of Communication Protocols}

This section describes the communication protocols used within \progname{}. 
Communication occurs between the client-facing dashboard, the real-time 
streaming backend, the analytics components, and the system’s secure storage 
infrastructure. All communication follows a modular service-based pattern 
where each module exposes a set of services that may be invoked by higher-level 
modules as shown in the uses hierarchy.

\subsection{11.1 Overall Architecture}

System communication is organized around three main channels:

\begin{itemize}
  \item \textbf{Real-Time Data Delivery:} Raw gaze streams and aggregated 
  attention metrics are transmitted from the Data Ingestion and Real-Time 
  Streaming modules to the Dashboard Visualization module.
  
  \item \textbf{Asynchronous Analytics Pipeline:} Preprocessed gaze data is 
  passed from the Data Preprocessing module to the Engagement Analytics and 
  Correlation \& Visual Analysis modules for metric generation.

  \item \textbf{Secure Storage and Retrieval:} Privacy \& Infrastructure 
  manages anonymized storage of both raw and processed data, making it 
  accessible to authorized modules such as Reporting.
\end{itemize}

All communication follows structured data formats, with components interacting 
through well-defined access routines specified in the MIS. Communication does 
not rely on shared global state; instead, modules exchange data through 
explicit service calls or via the streaming pipeline.

\subsection{11.2 Data Flow Patterns}

Communication follows two major patterns:

\begin{itemize}
  \item \textbf{Push-Based Real-Time Streaming:} The Real-Time Streaming module 
  (M3) pushes processed gaze data and attention indicators to the Dashboard 
  Visualization module (M4). This enables instructors to view attention trends 
  with minimal latency.

  \item \textbf{Pull-Based Analysis and Reporting:} The Engagement Analytics 
  module (M8), Correlation \& Visual Analysis module (M9), and Reporting module 
  (M5) request preprocessed or stored data from the Privacy \& Infrastructure 
  module (M7) and Data Preprocessing module (M6) as needed to compute summary 
  statistics or generate class reports.
\end{itemize}

\subsubsection*{Temporal Characteristics}

\begin{itemize}
  \item Real-time streams operate on short intervals (approximately 1–2 seconds).
  \item Analytics requests are event-driven rather than continuous.
  \item Reporting operations occur after class and may be batched.
\end{itemize}

\subsection{11.3 Message Types}

Modules exchange data using structured message formats. Typical messages include:

\begin{itemize}
  \item \textbf{GazeFrame:} Raw or preprocessed gaze coordinates, timestamps, 
  pupil size, and detection confidence.

  \item \textbf{AttentionSummary:} Aggregated per-region or per-student 
  attention metrics computed by the Engagement Analytics module.

  \item \textbf{CorrelationMap:} Data structures produced by the Correlation \& 
  Visual Analysis module describing gaze distribution heatmaps.

  \item \textbf{SessionRecord:} Metadata describing a class session, stored and 
  retrieved through the Privacy \& Infrastructure module.

  \item \textbf{ReportBundle:} Final compiled data provided to the Reporting 
  module for output formatting.
\end{itemize}

These message formats allow the system to maintain a separation of concerns: 
modules only require knowledge of the structure of the data they consume, 
not how it was generated.

\subsection{11.4 Privacy and Security Constraints}

All communication adheres to the privacy and security requirements outlined in 
the Hazard Analysis. Key protections include:

\begin{itemize}
  \item \textbf{Anonymization:} No personal identifiers are stored or transmitted 
  with gaze data.
  \item \textbf{Access Control:} Only authorized modules may request stored 
  data from M7 (Privacy \& Infrastructure).
  \item \textbf{Data Minimization:} Real-time streaming transmits only 
  aggregated or anonymized indicators rather than raw identifying visual data.
  \item \textbf{Integrity Checks:} Modules using stored datasets perform 
  checksum or timestamp validation to avoid stale or corrupted data.
\end{itemize}

\subsection{11.5 Design Considerations}

The communication protocol design prioritizes:

\begin{itemize}
  \item \textbf{Low Latency:} Real-time streaming ensures timely updates for 
  instructors during live sessions.
  \item \textbf{Scalability:} Analytics modules operate independently of the 
  real-time pipeline, allowing more complex computations without slowing down 
  the dashboard.
  \item \textbf{Modularity:} Modules communicate through stable abstractions 
  defined in the MIS, reducing interdependencies.
  \item \textbf{Reliability:} Data retrieval and reporting do not depend on 
  the continuous availability of real-time processes, enabling fault tolerance.
\end{itemize}

This design ensures consistent, secure, and efficient communication between 
modules in \progname{}, supporting real-time visualization, post-session 
analysis, and long-term data storage.

\section{Timeline}

This section outlines the implementation timeline for \progname{}.  
The schedule is organized according to the module hierarchy described in 
Section~\ref{SecMH}, with lower‐level modules developed first to enable 
higher‐level functionality. The work is divided into phases that reflect the 
system’s data pipeline: ingestion, preprocessing, analytics, and visualization.

\subsection*{Phase 1 — Foundations and Hardware Integration}
\begin{itemize}
  \item \textbf{M1: Hardware-Hiding Module}  
  Set up and test Pupil Labs Neon glasses, central camera, and instructor 
  workstation. Confirm data access points and ensure that device drivers and 
  calibration tools function reliably.

  \item \textbf{M2: Data Ingestion Module}  
  Implement raw gaze and video capture, device synchronization, and 
  time-stamped buffering. Establish initial interfaces for downstream modules.
\end{itemize}

\subsection*{Phase 2 — Data Processing and Infrastructure}
\begin{itemize}
  \item \textbf{M6: Data Preprocessing Module}  
  Develop filtering, noise reduction, coordinate normalization, and 
  outlier detection routines. Produce preprocessed frames for use by analytics 
  modules.

  \item \textbf{M7: Privacy \& Infrastructure Module}  
  Implement anonymization, secure data storage, access control, and 
  infrastructure services (session management, integrity checks).
\end{itemize}

\subsection*{Phase 3 — Real-Time and Analytical Capabilities}
\begin{itemize}
  \item \textbf{M3: Real-Time Streaming Module}  
  Construct the pipeline for sending processed gaze frames and attention signals 
  to the dashboard at 1–2 second intervals.

  \item \textbf{M8: Engagement Analytics Module}  
  Build algorithms for attention scoring, fixation detection, and aggregated 
  engagement metrics.

  \item \textbf{M9: Correlation \& Visual Analysis Module}  
  Implement spatial correlation calculations, heatmap generation, and visual 
  analysis tools using preprocessed data and analytics outputs.
\end{itemize}

\subsection*{Phase 4 — User-Facing Interfaces}
\begin{itemize}
  \item \textbf{M4: Dashboard Visualization Module}  
  Integrate real-time streaming, analytics, and correlation outputs into a 
  unified instructor-facing dashboard. Design displays for class-level and 
  region-level attention indicators.

  \item \textbf{M5: Reporting Module}  
  Generate post-session summaries that combine analytics and visualizations. 
  Produce exports or formatted reports based on session data.
\end{itemize}

\subsection*{Phase 5 — Integration, Testing, and Refinement}
\begin{itemize}
  \item \textbf{System Integration}  
  Combine all modules into an end-to-end pipeline from ingestion to reporting. 
  Ensure consistent data formats and stable communication across modules.

  \item \textbf{Verification and Validation}  
  Conduct unit tests, integration tests, and scenario-based validation 
  following the VnV Plan. Address feedback based on latency, accuracy, and 
  usability tests.

  \item \textbf{Performance and Privacy Review}  
  Verify that modules meet privacy constraints, maintain real-time performance 
  targets, and operate reliably under varying classroom conditions.

  \item \textbf{Final Documentation and Deliverables}  
  Prepare final reports, updated design documents, and demonstration artifacts 
  for Rev 1 and project completion.
\end{itemize}

This phased timeline ensures that core data-handling components are completed 
first, enabling analytics and visualization to be developed on a stable 
foundation. It also supports iterative testing and refinement as the pipeline 
becomes fully integrated.

\bibliographystyle {plainnat}
\bibliography{../../../refs/References}

\newpage{}

\end{document}